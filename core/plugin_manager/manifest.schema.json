{
  "$id": "vivified.plugin.manifest.schema",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Vivified Plugin Manifest",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "id": { "type": "string", "pattern": "^[a-z0-9_.-]+$" },
    "name": { "type": "string", "minLength": 1 },
    "version": { "type": "string", "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z-.]+)?(?:\\+[0-9A-Za-z-.]+)?$" },
    "description": { "type": "string" },
    "contracts": { "type": "array", "items": { "type": "string" }, "minItems": 1 },
    "traits": { "type": "array", "items": { "type": "string" }, "minItems": 0 },
    "dependencies": { "type": "array", "items": { "type": "string" } },
    "allowed_domains": { "type": "array", "items": { "type": "string" } },
    "endpoints": { "type": "object", "additionalProperties": { "type": "string" } },
    "security": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "authentication": { "type": "string", "enum": ["oauth2", "api_key", "basic", "none"] },
        "scopes": { "type": "array", "items": { "type": "string" } },
        "header": { "type": "string" },
        "scheme": { "type": "string" },
        "token_url": { "type": "string" },
        "auth_url": { "type": "string" },
        "client_id_config_key": { "type": "string" },
        "client_secret_config_key": { "type": "string" }
      },
      "required": ["authentication"]
    },
    "compliance": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "hipaa_controls": { "type": "array", "items": { "type": "string" } },
        "audit_level": { "type": "string", "enum": ["standard", "detailed"] }
      }
    },
    "canonical_support": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "entities": { "type": "array", "items": { "type": "string" } },
        "event_subscriptions": { "type": "array", "items": { "type": "string" } }
      }
    },
    "rate_limits": { "type": "object", "additionalProperties": { "type": "integer", "minimum": 0 } }
  },
  "required": ["id", "name", "version", "contracts", "traits", "security", "compliance" ]
}

